process.chdir(__dirname)
const { dump } = require('../dist')
const fs = require('fs')
const { spawnSync } = require('child_process')
const data = dump(eval(process.argv[2]))
console.log(Buffer.from(data).toString('hex'))
fs.writeFileSync('a.data', Buffer.from(data))
fs.writeFileSync('a.rb', `pp Marshal.load IO.binread 'a.data'`)
spawnSync('ruby a.rb', { stdio: 'inherit', shell: true })
fs.unlinkSync('a.rb')
fs.unlinkSync('a.data')
